<!doctype html>
<html>
<head>
<meta charset="utf-8" />
<title>SnowHangMan</title>

<script>var zon = true; // true for comments from zim code</script>
<script src="http://d309knd7es5f10.cloudfront.net/zim_1.4.4_min.js"></script>
<script src="http://code.createjs.com/createjs-2015.05.21.min.js"></script> 
<!-- should use CDN links available from CreateJS and ZIM sites -->
<!-- <script src="js/asteroid1.js"></script> -->

<style>
	body {margin:0px; padding:0px; background-color:#000;}
	#myCanvas {position:absolute; background-color:#000;}
</style>

<script>

var scaling = "full"; // fit scales to fit the browser window while keeping the aspect ratio
var width = 960;
var height = 640;
var frame = new zim.Frame(scaling, width, height); 

frame.on("ready", function() {  
    
    var stage = frame.stage;
    var stageW = frame.width;
    var stageH = frame.height;

    
    // used for tiles if there are tiles
    var squareW = 120;
    var squareH = 90;
    var squareS = 20;
    
    var imagePath = "img/";
    var manifest = [{id:"backdrop", src:"backdrop.jpg"},
                    {id:"snowman1", src:"snowman-full.png"}];

    var preload = new createjs.LoadQueue(false, imagePath);
    preload.loadManifest(manifest);
    preload.on("complete", game);
    
    
    function game() {
        console.log("____Snowman Hangman____"); 

        var bounds = new zim.Rectangle(stageW, stageH, "#BB5145");
        stage.addChild(bounds);

        var backdropContainer = new zim.Rectangle(800,600,"transparent");
        stage.addChild(backdropContainer);
        backdropContainer.regX = backdropContainer.getBounds().width/2;
        backdropContainer.regY = backdropContainer.getBounds().height/2;
        backdropContainer.x = stageW/2;
        backdropContainer.y = stageH/2;
        var bdW = backdropContainer.getBounds().width;
        var bdH = backdropContainer.getBounds().height;

        var backdrop = new createjs.Bitmap(preload.getResult('backdrop'));
        stage.addChild(backdrop);
        zim.scaleTo(backdrop, backdropContainer, 100, 100);
        backdrop.x = stageW/2;
        backdrop.y = stageH/2;
        backdrop.regX = backdrop.getBounds().width/2;
        backdrop.regY = backdrop.getBounds().height/2;

        var snowmen = new zim.Rectangle(250,330,"transparent");
        stage.addChild(snowmen);
        snowmen.regX = snowmen.getBounds().width/2;
        snowmen.regY = snowmen.getBounds().height;
        snowmen.x = stageW/2 + 150;
        snowmen.y = stageH/4*3 - 50;

        var snowman1 = new createjs.Bitmap(preload.getResult('snowman1'));
        stage.addChild(snowman1);
        snowman1.regX = snowman1.getBounds().width/2;
        snowman1.regY = snowman1.getBounds().height;
        snowman1.x = stageW/2 + 150;
        snowman1.y = stageH/4*3 - 50;
        zim.scaleTo(snowman1, snowman1, 100, 100);

        var phraseContainer = new createjs.Container();
        stage.addChild(phraseContainer);

        var alphabet = ["A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L",
                        "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X",
                        "Y", "Z"];

        var phrases = ["MERRY CHRISTMAS", "DECK THE HALLS", "SILENT NIGHT", "JINGLE BELLS", "SANTA CLAUSE", "RUDOLPH", "TIS THE SEASON", "BAH HUMBUG", "LET IT SNOW", "WHITE CHRISTMAS", "CHRISTMAS EVE", "CORN COB PIPE", "FROSTY"]

        function createPhrase() {

            var phrase;
            for(j=0;j<phrases.length;j++){
                var rand = Math.floor(Math.random()*phrases.length);
                phrase = phrases[rand];
            }

            var pos = stageW/2 - 350;
            
            for(i=0; i<phrase.length; i++) {
                if(phrase[i] != " ") {

                    var container = new zim.Rectangle(25,50,"transparent");
                    container.alpha = 0;
                    phraseContainer.addChild(container);
                    container.x = pos;
                    container.y = stageH/2 - 225;
                    pos = container.x + 25;
                    container.letter = phrase[i];

                    var text = new createjs.Text(phrase[i], "20px Arial", "#BB5145");
                    container.addChild(text);
                    text.regX = text.getBounds().width/2;
                    text.regY = text.getBounds().height/2;
                    text.x = container.getBounds().width/2;
                    text.y = container.getBounds().height/2;

                    var blank = new zim.Rectangle(20,3,"white");
                    stage.addChild(blank);
                    blank.regX = blank.getBounds().width/2;
                    blank.regY = blank.getBounds().height;
                    blank.x = pos - 25 + container.getBounds().width/2;
                    blank.y = stageH/2 - 225 + container.getBounds().height;

                } else {
                    var container = new zim.Rectangle(25,50,"transparent");
                    stage.addChild(container);
                    container.x = pos;
                    container.alpha = 0;
                    pos = container.x + 25;
                    container.letter = phrase[i];                    
                }
            }

            return container;
        }

        createPhrase();

        var letterBoard = new zim.Rectangle(390, 100,"#BB5145", "#BB5145", 3);
        stage.addChild(letterBoard);
        letterBoard.x = stageW/2 - 350;
        letterBoard.y = stageH/2 + 100;

        var letterBoardTitle = new zim.Rectangle(390, 50, "#BB5145", "#BB5145", 3);
        letterBoard.addChild(letterBoardTitle);

        letterBoardTitle.regY = letterBoardTitle.getBounds().height;
        letterBoardTitle.y = 0;

        var letterBoardTitleText = new createjs.Text("Select a letter here", "20px Arial", "white");
        letterBoardTitle.addChild(letterBoardTitleText);
        letterBoardTitleText.regX = letterBoardTitleText.getBounds().width/2;
        letterBoardTitleText.regY = letterBoardTitleText.getBounds().height/2;
        letterBoardTitleText.x = letterBoardTitle.getBounds().width/2;
        letterBoardTitleText.y = letterBoardTitle.getBounds().height/2;

        createLetters();

        function createLetters() {
            var posX = stageW/2 - 350;
            var posY = stageH/2 + 100;
            for(i=0;i<alphabet.length;i++){

                // var letterBox = new zim.Rectangle(30,50,"#3FB07C");
                var letterBox = new zim.Rectangle(30,50,"white");
                stage.addChild(letterBox);
                letterBox.letter = alphabet[i];
                letterBox.addEventListener("click", guessLetter);

                letterBox.letters = alphabet[i];
                if(posX >= stageW/2 - 350 + 390){
                    posX = stageW/2 - 350;
                    posY = stageH/2 + 100 + 50;
                    letterBox.x = posX;
                    letterBox.y = posY;
                    posX = letterBox.x + 30;
                } else {
                    letterBox.x = posX;
                    letterBox.y = posY;
                    posX = letterBox.x + 30;
                }

                var letterz = new createjs.Text(alphabet[i], "20px Arial", "#BB5145");
                letterBox.addChild(letterz);
                letterz.regX = letterz.getBounds().width/2;
                letterz.regY = letterz.getBounds().height/2;
                letterz.x = letterBox.getBounds().width/2;
                letterz.y = letterBox.getBounds().height/2;
                letterz.alpha = 1;

            }

            return letterBox;

        }

        function guessLetter(e){
            for(i=0;i<phraseContainer.numChildren;i++){
                if(phraseContainer.getChildAt(i).letter == e.target.letters){
                    phraseContainer.getChildAt(i).alpha = 1;
                    stage.update();
                } 
            }
        }

        // createjs.Ticker.framerate = 60;
        // createjs.Ticker.on("tick", function(){
        //     for(i=2;i<letterBoard.numChildren;i++){
        //         letterBoard.getChildAt(i).addEventListener("click", function(){
        //             console.log("clicked");
        //         })
        //     }
        // })
        
        var bounding = bounds.getChildAt[0];
        console.log(bounding);
        

        console.log("end of code");
        stage.update(); 
    } 

});



</script>


</head>

<body>
</body>
</html>